<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="shortcut icon" href="{{ url_for('static', filename='assets/images/logo/logo-2.svg') }}" type="image/x-icon" />
    <title>Expectant Mother - Gladney Center</title>

    <!-- ========== CSS ========= -->
    <link rel="stylesheet" href="{{ url_for('static', filename='assets/css/bootstrap.min.css') }}" />
    <link rel="stylesheet" href="{{ url_for('static', filename='assets/css/lineicons.css') }}" />
    <link rel="stylesheet" href="{{ url_for('static', filename='assets/css/materialdesignicons.min.css') }}" />
    <link rel="stylesheet" href="{{ url_for('static', filename='assets/css/main.css') }}" />

<style>

  header.header {
  position: sticky;   /* ou fixed, se preferir */
  top: 0;
  z-index: 50;        /* acima do conteúdo */
  background: #fff;   /* fundo sólido para não sobrepor */
}

  /* ===== Base: ocupar a viewport sem “respiro” extra ===== */
  html, body { height: 100%; }
  body { margin: 0; overflow: hidden; } /* se quiser rolagem, troque por overflow:auto */

  /* ===== Layout principal (100% da viewport real) ===== */
  .main-wrapper {
    height: 100dvh;
    display: flex;
    flex-direction: column;
  }

  /* A seção cresce e permite o filho “esticar” */
  .section {
    flex: 1 1 auto;
    min-height: 0;
    overflow: hidden;
  }

  /* Empilha conteúdo interno e remove padding extra no fim */
  .section .container-fluid {
    height: 100%;
    display: flex;
    flex-direction: column;
    padding-bottom: 0 !important;
  }

  /* ===== Viewer (container + iframe) ===== */
  #iframeWrap.iframe-wrap,
  .iframe-wrap {
    flex: 1 1 auto;
    min-height: 240px;
    height: auto !important;   /* o JS ajusta a altura exata até o fim da tela */
    display: flex;
    flex-direction: column;
    width: 100%;
    border: 1px solid #e5e7eb;
    border-radius: 12px;
    overflow: hidden;
    background: #fff;
    box-shadow: inset 0 8px 20px rgba(17,24,39,.04);
  }

  #iframeWrap iframe,
  .iframe-wrap iframe {
    flex: 1 1 auto;
    width: 100%;
    height: 100%;
    border: 0;
  }

  /* Fullscreen continua ocupando tudo */
  .iframe-wrap:fullscreen { height: 100vh; }
  .iframe-wrap:fullscreen .top-menu-fs {
    display: flex;
    position: sticky;
    top: 0;
    z-index: 2;
  }

  /* ===== Título / Barra superior ===== */
  .title-wrapper { padding-top: 0 !important; margin-bottom: 0 !important; }

  .top-row {
    display: grid;
    grid-template-columns: 1fr auto 1fr;
    align-items: center;
    gap: 12px;
    margin: 10px 0 14px 0;
    background: #fff;
    border: 1px solid #e5e7eb;
    border-radius: 12px;
    box-shadow: 0 6px 18px rgba(17,24,39,.06);
    padding: 8px 12px;
    flex: 0 0 auto;
  }

  /* ===== MENU HORIZONTAL principal ===== */
  .top-menu {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 10px;
    margin: 10px 0 14px 0;
    padding: 8px 10px;
    background: #fff;
    border: 1px solid #e5e7eb;
    border-radius: 12px;
    box-shadow: 0 6px 18px rgba(17,24,39,.06);
    width: 100%;
  }
  .top-row .top-menu {
    margin: 0;
    width: auto;
    background: transparent;
    border: 0;
    box-shadow: none;
    padding: 0;
    grid-column: 2;
  }

  .top-menu .tab,
  .top-menu .dropdown-btn {
    appearance: none;
    padding: 10px 16px;
    border-radius: 999px;
    border: 1px solid #e5e7eb;
    background: #fff;
    color: #374151;
    font-size: 14px;
    line-height: 1;
    cursor: pointer;
    transition: border-color .15s ease, color .15s ease, box-shadow .15s ease, background .15s ease;
  }
  .top-menu .tab:hover,
  .top-menu .dropdown-btn:hover {
    border-color: #c7cce5;
    box-shadow: 0 4px 12px rgba(63,81,181,.12);
  }
  .top-menu .tab:focus-visible,
  .top-menu .dropdown-btn:focus-visible,
  .dropdown-item:focus-visible {
    outline: 3px solid rgba(63,81,181,.25);
    outline-offset: 2px;
  }
  .top-menu .tab[aria-selected="true"],
  .top-menu .dropdown[aria-expanded="true"] .dropdown-btn {
    background: #3F51B5;
    color: #fff;
    border-color: #3F51B5;
    box-shadow: 0 8px 20px rgba(63,81,181,.22);
  }
  .dropdown-btn::after {
    content: "▾";
    margin-left: .4rem;
    font-size: .8rem;
    opacity: .8;
  }

  /* ===== Dropdown e Submenu ===== */
  .dropdown { position: relative; display: inline-block; }
  .dropdown-menu {
    position: absolute;
    top: calc(100% + 8px);
    left: 0;
    min-width: 260px;
    padding: 8px;
    background: #fff;
    border: 1px solid #e5e7eb;
    border-radius: 12px;
    box-shadow: 0 12px 28px rgba(17,24,39,.12);
    display: none;
    z-index: 20;
  }
  .dropdown[aria-expanded="true"] .dropdown-menu { display: block; }

  .dropdown-item {
    display: block;
    width: 100%;
    text-align: left;
    border: 0;
    background: #fff;
    padding: 10px 12px;
    border-radius: 10px;
    cursor: pointer;
    color: #374151;
    font-size: 14px;
    transition: background .12s ease, color .12s ease;
  }
  .dropdown-item:hover { background: #f3f4f6; }
  .dropdown-item[aria-selected="true"] {
    background: #e8eaf6;
    color: #3F51B5;
    font-weight: 600;
  }
  .dropdown-item[aria-selected="true"]::after {
    content: "✓";
    float: right;
    opacity: .9;
  }

  /* Submenu (segundo nível) */
  .has-submenu { position: relative; padding-right: 26px; }
  .has-submenu::after {
    content: "▸";
    position: absolute;
    right: 10px;
    top: 50%;
    transform: translateY(-50%);
    opacity: .6;
    font-size: .9rem;
  }
  .submenu {
    position: absolute;
    left: 100%;
    top: 0;
    min-width: 260px;
    padding: 8px;
    background: #fff;
    border: 1px solid #e5e7eb;
    border-radius: 12px;
    box-shadow: 0 12px 28px rgba(17,24,39,.12);
    display: none;
    z-index: 25;
  }
  .has-submenu:hover > .submenu,
  .has-submenu[aria-expanded="true"] > .submenu { display: block; }

  @media (max-width: 992px) {
    .submenu { left: auto; right: 0; top: 100%; }
    .has-submenu::after { content: "▾"; }
  }

  /* ===== Botão expandir ===== */
  .expand-btn {
    grid-column: 3;
    justify-self: end;
    background: #3F51B5;
    color: #fff;
    border: 0;
    border-radius: 10px;
    padding: 8px 14px;
    font-size: 14px;
    cursor: pointer;
    box-shadow: 0 6px 18px rgba(17,24,39,.12);
    transition: filter .2s ease;
  }
  .expand-btn:hover { filter: brightness(0.92); }

  @media (max-width: 576px) {
    .top-row { grid-template-columns: 1fr auto; }
    .top-row .top-menu { grid-column: 1; }
    .expand-btn { grid-column: 2; }
  }

  /* ===== Menu exibido somente no fullscreen ===== */
  .top-menu-fs {
    display: none;
    margin: 0;
    width: 100%;
    justify-content: center;
    background: #fff;
    border-bottom: 1px solid #e5e7eb;
    border-radius: 0;
    box-shadow: 0 6px 18px rgba(17,24,39,.06);
    padding: 8px 12px;
  }
</style>



  </head>

  <body>
    <!-- ======== Preloader =========== -->
    <div id="preloader"><div class="spinner"></div></div>

    <!-- ======== sidebar-nav start =========== -->
    <aside class="sidebar-nav-wrapper" style="display:flex;flex-direction:column;height:100vh;">
      <div class="navbar-logo">
        <a href="{{ url_for('expectant_mother') }}">
          <img src="{{ url_for('static', filename='assets/images/logo/logo.svg') }}" alt="logo" style="width:220px;height:auto;" />
          <br />
        </a>
      </div>
      <nav class="sidebar-nav">
        <ul>
          <li class="nav-item nav-item-has-children">
            <a href="#0" data-bs-toggle="collapse" data-bs-target="#ddmenu_1" aria-controls="ddmenu_1" aria-expanded="false" aria-label="Toggle navigation">
              <span class="icon"><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8.75 18.3333C12.2376 18.3333 15.1364 15.8128 15.7244 12.4941C15.8448 11.8143 15.2737 11.25 14.5833 11.25H10C9.30966 11.25 8.75 10.6903 8.75 10V5.41666C8.75 4.7263 8.18563 4.15512 7.50586 4.27556C4.18711 4.86357 1.66666 7.76243 1.66666 11.25C1.66666 15.162 4.83797 18.3333 8.75 18.3333Z"/><path d="M17.0833 10C17.7737 10 18.3432 9.43708 18.2408 8.75433C17.7005 5.14918 14.8508 2.29947 11.2457 1.75912C10.5629 1.6568 10 2.2263 10 2.91665V9.16666C10 9.62691 10.3731 10 10.8333 10H17.0833Z"/></svg></span>
              <span class="text">Dashboard</span>
            </a>
            <ul id="ddmenu_1" class="collapse show dropdown-nav">
              <li><a href="{{ url_for('expectant_mother') }}" class="active">Expectant Mother</a></li>
              <li><a href="{{ url_for('gladney_business_performance') }}">Gladney Business Performance</a></li>
              <li><a href="{{ url_for('page_traffic_monitor') }}">Page Traffic Monitor</a></li>
            </ul>
          </li>

          <li class="nav-item nav-item-has-children">
            <a href="#0" class="collapsed" data-bs-toggle="collapse" data-bs-target="#ddmenu_4" aria-controls="ddmenu_4" aria-expanded="false" aria-label="Toggle navigation">
              <span class="icon"><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1.66666 5.41669C1.66666 3.34562 3.34559 1.66669 5.41666 1.66669C7.48772 1.66669 9.16666 3.34562 9.16666 5.41669C9.16666 7.48775 7.48772 9.16669 5.41666 9.16669C3.34559 9.16669 1.66666 7.48775 1.66666 5.41669Z"/><path d="M1.66666 14.5834C1.66666 12.5123 3.34559 10.8334 5.41666 10.8334C7.48772 10.8334 9.16666 12.5123 9.16666 14.5834C9.16666 16.6545 7.48772 18.3334 5.41666 18.3334C3.34559 18.3334 1.66666 16.6545 1.66666 14.5834Z"/><path d="M10.8333 5.41669C10.8333 3.34562 12.5123 1.66669 14.5833 1.66669C16.6544 1.66669 18.3333 3.34562 18.3333 5.41669C18.3333 7.48775 16.6544 9.16669 14.5833 9.16669C12.5123 9.16669 10.8333 7.48775 10.8333 5.41669Z"/><path d="M10.8333 14.5834C10.8333 12.5123 12.5123 10.8334 14.5833 10.8334C16.6544 10.8334 18.3333 12.5123 18.3333 14.5834C18.3333 16.6545 16.6544 18.3334 14.5833 18.3334C12.5123 18.3334 10.8333 16.6545 10.8333 14.5834Z"/></svg></span>
              <span class="text">Information</span>
            </a>
            <ul id="ddmenu_4" class="collapse dropdown-nav">
              <li><a href="{{ url_for('dashboard_details')}}">Dashboard Details</a></li>
              <li><a href="{{ url_for('dashboard_faq') }}">Dashboard FAQ</a></li>
            </ul>
          </li>

          <li class="nav-item">
            <a href="{{ url_for('notification') }}">
              <span class="icon"><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10.8333 2.50008C10.8333 2.03984 10.4602 1.66675 9.99999 1.66675C9.53975 1.66675 9.16666 2.03984 9.16666 2.50008C9.16666 2.96032 9.53975 3.33341 9.99999 3.33341C10.4602 3.33341 10.8333 2.96032 10.8333 2.50008Z"/><path d="M17.5 5.41673C17.5 7.02756 16.1942 8.33339 14.5833 8.33339C12.9725 8.33339 11.6667 7.02756 11.6667 5.41673C11.6667 3.80589 12.9725 2.50006 14.5833 2.50006C16.1942 2.50006 17.5 3.80589 17.5 5.41673Z"/><path d="M11.4272 2.69637C10.9734 2.56848 10.4947 2.50006 10 2.50006C7.10054 2.50006 4.75 4.85057 4.75 7.75006V9.20873C4.75 9.72814 4.62082 10.2393 4.37404 10.6963L3.36705 12.5611C2.89938 13.4272 3.26806 14.5081 4.16749 14.9078C7.88074 16.5581 12.1193 16.5581 15.8326 14.9078C16.732 14.5081 17.1007 13.4272 16.633 12.5611L15.626 10.6963C15.43 10.3333 15.3081 9.93606 15.2663 9.52773C15.0441 9.56431 14.8159 9.58339 14.5833 9.58339C12.2822 9.58339 10.4167 7.71791 10.4167 5.41673C10.4167 4.37705 10.7975 3.42631 11.4272 2.69637Z"/><path d="M7.48901 17.1925C8.10004 17.8918 8.99841 18.3335 10 18.3335C11.0016 18.3335 11.9 17.8918 12.511 17.1925C10.8482 17.4634 9.15183 17.4634 7.48901 17.1925Z"/></svg></span>
              <span class="text">Notifications</span>
            </a>
          </li>
        </ul>
      </nav>

      <div class="promo-box" style="position:absolute;bottom:20px;left:50%;transform:translateX(-50%);width:auto;padding:10px 25px;">
        <div class="text-center">
          <img class="mx-auto" src="{{ url_for('static', filename='assets/images/logo/logo-icon-big.jpeg') }}" alt="Logo" style="width:40px;height:auto;" />
          <div><small style="font-size:10px;">Powered by UpStart13</small></div>
        </div>
      </div>
    </aside>
    <div class="overlay"></div>
    <!-- ======== sidebar-nav end =========== -->

    <!-- ======== main-wrapper start =========== -->
    <main class="main-wrapper">
            <header class="header">
        <div class="container-fluid">
          <div class="row">
            <div class="col-lg-5 col-md-5 col-6">
              <div class="header-left d-flex align-items-center">
                <div class="header-left d-flex align-items-center">
                  <div class="header-left d-flex align-items-center">
                   <div class="menu-toggle-btn">
                    <button id="menu-toggle" style="background: none; border: none; padding: 0; display: flex; align-items: center; cursor: pointer; margin-left: -20px;">
                      <img src="{{ url_for('static', filename='assets/images/icons/svg-hamburger-icon-11.jpg') }}" alt="Menu" style="width: 30px; height: 30px; margin-right: 0px;">
                      <span style="font-size: 16px; line-height: 1; color: #333; margin-top: -2px;">Menu</span>
                    </button>
                  </div>
                  </div>
              </div>
              </div>
            </div>
            <div class="col-lg-7 col-md-7 col-6">
              <div class="header-right">
                <!-- notification start -->
                <div class="notification-box ml-15 d-none d-md-flex">
                  <button class="dropdown-toggle" type="button" id="notification" data-bs-toggle="dropdown"
                    aria-expanded="false">
                    <svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path
                        d="M11 20.1667C9.88317 20.1667 8.88718 19.63 8.23901 18.7917H13.761C13.113 19.63 12.1169 20.1667 11 20.1667Z"
                        fill="" />
                      <path
                        d="M10.1157 2.74999C10.1157 2.24374 10.5117 1.83333 11 1.83333C11.4883 1.83333 11.8842 2.24374 11.8842 2.74999V2.82604C14.3932 3.26245 16.3051 5.52474 16.3051 8.24999V14.287C16.3051 14.5301 16.3982 14.7633 16.564 14.9352L18.2029 16.6342C18.4814 16.9229 18.2842 17.4167 17.8903 17.4167H4.10961C3.71574 17.4167 3.5185 16.9229 3.797 16.6342L5.43589 14.9352C5.6017 14.7633 5.69485 14.5301 5.69485 14.287V8.24999C5.69485 5.52474 7.60672 3.26245 10.1157 2.82604V2.74999Z"
                        fill="" />
                    </svg>
                  </button>
                </div>
                <!-- notification end -->
                <!-- profile start -->
                <div class="profile-box ml-15">
                  <button class="dropdown-toggle bg-transparent border-0" type="button" id="profile"
                    data-bs-toggle="dropdown" aria-expanded="false">
                    <div class="profile-info d-flex align-items-center">
                      <div class="image">
                        <img src="{{ user.picture }}" alt="Profile Image" style="border-radius: 50%; width: 40px; height: 40px;" />
                      </div>
                      <div class="ms-2">
                        <h6 class="fw-500 mb-0">{{ user.name }}</h6>
                        <p class="mb-0" style="font-size: 12px;">{{ user.email }}</p>
                      </div>
                    </div>
                  </button>
                  <ul class="dropdown-menu" aria-labelledby="profile">
                    <li><a class="dropdown-item" href="{{ url_for('logout') }}">Logout</a></li>
                  </ul>
                </div>
                <!-- profile end -->
              </div>
            </div>
          </div>
        </div>
      </header>

      <section class="section">
        <div class="container-fluid">
          <div class="title-wrapper pt-30">
            <div class="row align-items-center">
              <div class="col-12">
                <!-- Título fora do card branco -->
                <div class="title" style="margin-bottom:10px;">
                  <h4>Expectant Mother</h4>
                </div>

                <!-- Barra completa -->
                <div class="top-row">
                  <div class="top-menu" role="tablist" aria-label="Dashboards">
                    <!-- ROOT 1 -->
                    <div id="dd-expectant" class="dropdown" aria-expanded="false">
                      <button id="tab-expectant" class="dropdown-btn" role="tab" aria-selected="true"
                              onclick="toggleDropdown('dd-expectant')">
                        Expectant Mother
                      </button>
                      <div class="dropdown-menu" role="menu" aria-label="Expectant Mother">
                        <button class="dropdown-item" data-group="expectant" data-key="overview_ads"    onclick="selectView(this)">Overview - ads & hubspot</button>
                        <button class="dropdown-item" data-group="expectant" data-key="overview_ga4"    onclick="selectView(this)">Overview - GA4</button>
                        <button class="dropdown-item" data-group="expectant" data-key="recent"          onclick="selectView(this)">Recent Perspective</button>
                        <button class="dropdown-item" data-group="expectant" data-key="google_ads"      onclick="selectView(this)">Google Ads Performance</button>
                        <button class="dropdown-item" data-group="expectant" data-key="campaign_break"  onclick="selectView(this)">Campaign Breakdown</button>
                        <button class="dropdown-item" data-group="expectant" data-key="campaign_costs"  onclick="selectView(this)">Campaign Costs</button>
                        <button class="dropdown-item" data-group="expectant" data-key="contact_cost"    onclick="selectView(this)">Contact x Cost</button>
                        <button class="dropdown-item" data-group="expectant" data-key="day_of_week"     onclick="selectView(this)">Day of the Week</button>
                        <button class="dropdown-item" data-group="expectant" data-key="campaign_ratios" onclick="selectView(this)">Campaign Ratios</button>
                        <button class="dropdown-item" data-group="expectant" data-key="contact_break"   onclick="selectView(this)">Contact Breakdown</button>
                        <button class="dropdown-item" data-group="expectant" data-key="spam_break"      onclick="selectView(this)">Spam Breakdown</button>
                      </div>
                    </div>

                    <!-- ROOT 2 -->
                    <div id="dd-marketing" class="dropdown" aria-expanded="false">
                      <button id="tab-marketing" class="dropdown-btn" role="tab" aria-selected="false"
                              onclick="toggleDropdown('dd-marketing')">
                        Marketing Performance
                      </button>
                      <div class="dropdown-menu" role="menu" aria-label="Marketing Performance">
                        <button class="dropdown-item" data-group="marketing" data-key="performance_time" onclick="selectView(this)">Performance over time</button>
                        <button class="dropdown-item" data-group="marketing" data-key="cost_per"         onclick="selectView(this)">Cost per…</button>
                        <button class="dropdown-item" data-group="marketing" data-key="table_download"   onclick="selectView(this)">Table for download</button>

                        <div class="dropdown-item has-submenu" aria-haspopup="true" aria-expanded="false">
                          <span>Enrollment Rate</span>
                          <div class="submenu" role="menu" aria-label="Enrollment Rate">
                            <button class="dropdown-item" data-group="marketing" data-key="enroll_placements" onclick="selectView(this)">Filter by Placements in Sugar</button>
                            <button class="dropdown-item" data-group="marketing" data-key="enroll_admission"  onclick="selectView(this)">Filter by Admission in Sugar</button>
                            <button class="dropdown-item" data-group="marketing" data-key="enroll_creation"   onclick="selectView(this)">Filter by Creation in Hubspot</button>
                            <button class="dropdown-item" data-group="marketing" data-key="enroll_timeseries" onclick="selectView(this)">Time Series</button>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- direita: Expandir -->
                  <button class="expand-btn" onclick="toggleFullscreen()">⛶ Expandir</button>
                </div>

              </div>
            </div>
          </div>

          <!-- Viewer: menu FS + iframe -->
          <div id="iframeWrap" class="iframe-wrap" aria-live="polite">
            <!-- mesmo menu no fullscreen (sem ids duplicados) -->
            <div class="top-menu top-menu-fs" role="tablist" aria-label="Dashboards (Fullscreen)">
              <div class="dropdown" aria-expanded="false">
                <button class="dropdown-btn" onclick="toggleDropdown(this.parentElement.id='fs-expectant')">Expectant Mother</button>
                <div class="dropdown-menu">
                  <button class="dropdown-item" data-group="expectant" data-key="overview_ads"    onclick="selectView(this)">Overview - ads & hubspot</button>
                  <button class="dropdown-item" data-group="expectant" data-key="overview_ga4"    onclick="selectView(this)">Overview - GA4</button>
                  <button class="dropdown-item" data-group="expectant" data-key="recent"          onclick="selectView(this)">Recent Perspective</button>
                  <button class="dropdown-item" data-group="expectant" data-key="google_ads"      onclick="selectView(this)">Google Ads Performance</button>
                  <button class="dropdown-item" data-group="expectant" data-key="campaign_break"  onclick="selectView(this)">Campaign Breakdown</button>
                  <button class="dropdown-item" data-group="expectant" data-key="campaign_costs"  onclick="selectView(this)">Campaign Costs</button>
                  <button class="dropdown-item" data-group="expectant" data-key="contact_cost"    onclick="selectView(this)">Contact x Cost</button>
                  <button class="dropdown-item" data-group="expectant" data-key="day_of_week"     onclick="selectView(this)">Day of the Week</button>
                  <button class="dropdown-item" data-group="expectant" data-key="campaign_ratios" onclick="selectView(this)">Campaign Ratios</button>
                  <button class="dropdown-item" data-group="expectant" data-key="contact_break"   onclick="selectView(this)">Contact Breakdown</button>
                  <button class="dropdown-item" data-group="expectant" data-key="spam_break"      onclick="selectView(this)">Spam Breakdown</button>
                </div>
              </div>

              <div class="dropdown" aria-expanded="false">
                <button class="dropdown-btn" onclick="toggleDropdown(this.parentElement.id='fs-marketing')">Marketing Performance</button>
                <div class="dropdown-menu">
                  <button class="dropdown-item" data-group="marketing" data-key="performance_time" onclick="selectView(this)">Performance over time</button>
                  <button class="dropdown-item" data-group="marketing" data-key="cost_per"         onclick="selectView(this)">Cost per…</button>
                  <button class="dropdown-item" data-group="marketing" data-key="table_download"   onclick="selectView(this)">Table for download</button>
                  <div class="dropdown-item has-submenu" aria-haspopup="true" aria-expanded="false">
                    <span>Enrollment Rate</span>
                    <div class="submenu">
                      <button class="dropdown-item" data-group="marketing" data-key="enroll_placements" onclick="selectView(this)">Filter by Placements in Sugar</button>
                      <button class="dropdown-item" data-group="marketing" data-key="enroll_admission"  onclick="selectView(this)">Filter by Admission in Sugar</button>
                      <button class="dropdown-item" data-group="marketing" data-key="enroll_creation"   onclick="selectView(this)">Filter by Creation in Hubspot</button>
                      <button class="dropdown-item" data-group="marketing" data-key="enroll_timeseries" onclick="selectView(this)">Time Series</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <iframe id="dashboard-iframe"
                    title="Gladney — Expectant Mother"
                    src="about:blank"
                    loading="lazy" frameborder="0"
                    referrerpolicy="no-referrer-when-downgrade"
                    sandbox="allow-scripts allow-same-origin allow-popups allow-popups-to-escape-sandbox">
            </iframe>
          </div>

        </div>
      </section>
    </main>

    <!-- ========= JS ========= -->
    <script src="{{ url_for('static', filename='assets/js/bootstrap.bundle.min.js') }}"></script>
    <script src="{{ url_for('static', filename='assets/js/Chart.min.js') }}"></script>
    <script src="{{ url_for('static', filename='assets/js/dynamic-pie-chart.js') }}"></script>
    <script src="{{ url_for('static', filename='assets/js/moment.min.js') }}"></script>
    <script src="{{ url_for('static', filename='assets/js/fullcalendar.js') }}"></script>
    <script src="{{ url_for('static', filename='assets/js/jvectormap.min.js') }}"></script>
    <script src="{{ url_for('static', filename='assets/js/world-merc.js') }}"></script>
    <script src="{{ url_for('static', filename='assets/js/polyfill.js') }}"></script>
    <script src="{{ url_for('static', filename='assets/js/main.js') }}"></script>

    <script>
      // === MAPA DE LOOKERS (seus links)
      const LOOKERS = {
        expectant: {
          overview_ads:    'https://lookerstudio.google.com/embed/reporting/018fe7d3-8e30-4a70-86e9-ac5b71bdb662/page/p_03hj6qcmvd',
          overview_ga4:    'https://lookerstudio.google.com/embed/reporting/018fe7d3-8e30-4a70-86e9-ac5b71bdb662/page/p_8k5zdcvuvd',
          recent:          'https://lookerstudio.google.com/embed/reporting/018fe7d3-8e30-4a70-86e9-ac5b71bdb662/page/p_rbf34iv8ud',
          google_ads:      'https://lookerstudio.google.com/embed/reporting/018fe7d3-8e30-4a70-86e9-ac5b71bdb662/page/p_8eecz0rovd',
          campaign_break:  'https://lookerstudio.google.com/embed/reporting/018fe7d3-8e30-4a70-86e9-ac5b71bdb662/page/p_tadcyerovd',
          campaign_costs:  'https://lookerstudio.google.com/embed/reporting/018fe7d3-8e30-4a70-86e9-ac5b71bdb662/page/p_ep8hx4qovd',
          contact_cost:    'https://lookerstudio.google.com/embed/reporting/018fe7d3-8e30-4a70-86e9-ac5b71bdb662/page/p_jvidqwqovd',
          day_of_week:     'https://lookerstudio.google.com/embed/reporting/018fe7d3-8e30-4a70-86e9-ac5b71bdb662/page/p_1cwm5jqovd',
          campaign_ratios: 'https://lookerstudio.google.com/embed/reporting/018fe7d3-8e30-4a70-86e9-ac5b71bdb662/page/p_zx6sodqovd',
          contact_break:   'https://lookerstudio.google.com/embed/reporting/018fe7d3-8e30-4a70-86e9-ac5b71bdb662/page/p_1r1tjgpovd',
          spam_break:      'https://lookerstudio.google.com/embed/reporting/018fe7d3-8e30-4a70-86e9-ac5b71bdb662/page/p_an0bb3povd',
        },
        marketing: {
          performance_time:  'https://lookerstudio.google.com/embed/reporting/018fe7d3-8e30-4a70-86e9-ac5b71bdb662/page/p_hxd854tovd',
          cost_per:          'https://lookerstudio.google.com/embed/reporting/018fe7d3-8e30-4a70-86e9-ac5b71bdb662/page/p_3i0yaalovd',
          table_download:    'https://lookerstudio.google.com/embed/reporting/018fe7d3-8e30-4a70-86e9-ac5b71bdb662/page/p_4wsin3lovd',
          enroll_placements: 'https://lookerstudio.google.com/embed/reporting/018fe7d3-8e30-4a70-86e9-ac5b71bdb662/page/p_p95uwh89vd',
          enroll_admission:  'https://lookerstudio.google.com/embed/reporting/018fe7d3-8e30-4a70-86e9-ac5b71bdb662/page/p_72wuuqv6vd',
          enroll_creation:   'https://lookerstudio.google.com/embed/reporting/018fe7d3-8e30-4a70-86e9-ac5b71bdb662/page/p_o9fkb2oavd',
          enroll_timeseries: 'https://lookerstudio.google.com/embed/reporting/018fe7d3-8e30-4a70-86e9-ac5b71bdb662/page/p_094a1q3nvd',
        }
      };

      // === Helpers
      function setIframe(url){
        const wrap = document.getElementById('iframeWrap');
        const iframe = document.getElementById('dashboard-iframe');
        wrap.classList.remove('iframe-loaded');
        iframe.src = url;
      }
      function toggleDropdown(id){
        const dd = document.getElementById(id);
        if (!dd) return;
        dd.setAttribute('aria-expanded', dd.getAttribute('aria-expanded')==='true' ? 'false' : 'true');
      }
      function closeAllMenus(){
        document.querySelectorAll('.dropdown[aria-expanded="true"]').forEach(el => el.setAttribute('aria-expanded','false'));
        document.querySelectorAll('.has-submenu[aria-expanded="true"]').forEach(el => el.setAttribute('aria-expanded','false'));
      }

      // === Seleção (qualquer item, de qualquer nível)
      function selectView(btn){
        const group = btn.getAttribute('data-group');
        const key   = btn.getAttribute('data-key');

        // marca raiz ativa
        document.getElementById('tab-expectant')?.setAttribute('aria-selected', group === 'expectant' ? 'true':'false');
        document.getElementById('tab-marketing')?.setAttribute('aria-selected', group === 'marketing' ? 'true':'false');

        // marca item ativo
        document.querySelectorAll('.dropdown-item[aria-selected="true"]').forEach(i=>i.setAttribute('aria-selected','false'));
        btn.setAttribute('aria-selected','true');

        // troca relatório
        const url = LOOKERS?.[group]?.[key];
        if (url) setIframe(url);

        // === AJUSTE IMEDIATO DA ALTURA ===
        sizeViewer();

        // deep-link
        const u = new URL(window.location);
        u.searchParams.set('group', group);
        u.searchParams.set('view', key);
        window.history.replaceState({}, '', u);

        closeAllMenus();
      }

      // init (abre padrão ou pela querystring)
      (function initFromQuery(){
        const u = new URL(window.location);
        const group = u.searchParams.get('group') || 'expectant';
        const view  = u.searchParams.get('view')  || 'overview_ads';
        const el = document.querySelector(`.dropdown-item[data-group="${group}"][data-key="${view}"]`);
        if (el) selectView(el);
        else {
          const first = document.querySelector('.dropdown-item[data-group][data-key]');
          if (first) selectView(first);
        }
      })();

      // Fullscreen
      function toggleFullscreen() {
        const el = document.getElementById('iframeWrap');
        if (!document.fullscreenElement) { el.requestFullscreen?.(); }
        else { document.exitFullscreen?.(); }
      }
    
      // === FUNÇÃO sizeViewer() ADICIONADA ===
      function sizeViewer(){
        const wrap = document.getElementById('iframeWrap');
        if (!wrap) return;
        const header = document.querySelector('header.header');
      const headerH = header ? header.offsetHeight : 0;
      const vh = (window.visualViewport ? window.visualViewport.height : window.innerHeight);
      const available = Math.max(vh - headerH - wrap.offsetTop, 220);
        wrap.style.setProperty('height', available + 'px', 'important');
      }
    </script>

  <script>
    function sizeViewer(){
      const wrap = document.getElementById('iframeWrap');
      if (!wrap) return;

      // altura visível da viewport
      const vh = (window.visualViewport ? window.visualViewport.height : window.innerHeight);

      // distância do topo do wrap até o topo da viewport (já considera o header sticky)
      const top = wrap.getBoundingClientRect().top;

      // ocupa do topo do wrap até o fim da viewport
      const available = Math.max(vh - top, 220);

      wrap.style.setProperty('height', available + 'px', 'important');
    }
  </script>



  </body>
</html>
